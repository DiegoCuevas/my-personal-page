<!DOCTYPE html><html lang="es"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Como crear un Bot de discord usando Ruby - Diego Cuevas</title><link rel="icon" href="/static/favicon.png"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="description" content="En este articulo explicar√© como hacer un bot que mande memes a tu servidor de discord usando solo ruby ü§†"/><meta name="language" content="es"/><meta name="author" content="Diego Cuevas"/><meta name="pagename" content="Diego Cuevas"/><meta name="HandheldFriendly" content="True"/><meta name="MobileOptimized" content="320"/><meta name="robots" content="index, follow"/><meta name="theme-color" content="black"/><meta name="apple-mobile-web-app-title" content="Diego Cuevas"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Diego Cuevas"/><meta property="og:type" content="website"/><meta property="og:title" content="Como crear un Bot de discord usando Ruby"/><meta property="og:description" content="En este articulo explicar√© como hacer un bot que mande memes a tu servidor de discord usando solo ruby ü§†"/><meta property="og:image" content="https://i.microlink.io/https%3A%2F%2Fcards.microlink.io%2F%3Fpreset%3Dcontentz%26title%3DComo%20crear%20un%20Bot%20de%20discord%20usando%20Ruby%26description%3DEn%20este%20articulo%20explicar%C3%A9%20como%20hacer%20un%20bot%20que%20mande%20memes%20a%20tu%20servidor%20de%20discord%20usando%20solo%20ruby%20%F0%9F%A4%A0"/><meta property="og:image:alt" content="En este articulo explicar√© como hacer un bot que mande memes a tu servidor de discord usando solo ruby ü§†"/><meta property="og:url" content="https://diegocuevas.dev/articles/discord_bot/"/><meta property="og:site_name" content="Diego Cuevas"/><meta property="og:locale" content="es"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:url" content="https://diegocuevas.dev/articles/discord_bot/"/><meta name="twitter:title" content="Como crear un Bot de discord usando Ruby"/><meta name="twitter:description" content="En este articulo explicar√© como hacer un bot que mande memes a tu servidor de discord usando solo ruby ü§†"/><meta name="twitter:image" content="https://i.microlink.io/https%3A%2F%2Fcards.microlink.io%2F%3Fpreset%3Dcontentz%26title%3DComo%20crear%20un%20Bot%20de%20discord%20usando%20Ruby%26description%3DEn%20este%20articulo%20explicar%C3%A9%20como%20hacer%20un%20bot%20que%20mande%20memes%20a%20tu%20servidor%20de%20discord%20usando%20solo%20ruby%20%F0%9F%A4%A0"/><meta name="twitter:summary" content="Software Engineer"/><link rel="prefetch" href="/"/><link rel="prefetch" href="/articles/"/><link rel="prefetch" href="/articles/discord_bot/"/><link rel="prefetch" href="/articles/first_article/"/></head><style data-emotion-css="uqfbns-Document">.css-uqfbns-Document{background:white;color:black;margin:0;font-size:18px;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;}</style><body class="css-uqfbns-Document"><main><style data-emotion-css="1s16p6n-Layout">.css-1s16p6n-Layout{position:relative;}</style><div class="css-1s16p6n-Layout"><style data-emotion-css="1yl5nnh-Header">.css-1yl5nnh-Header{background:white;border-bottom:1px solid #eaeaea;box-shadow:0px 0px 10px 0px rgba(0,0,0,0.12);padding:1em 0;}@media print{.css-1yl5nnh-Header{display:none;}}</style><header class="css-1yl5nnh-Header"><style data-emotion-css="188wkox-Header">.css-188wkox-Header{max-width:60rem;margin:0 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}@media (max-width:60rem){.css-188wkox-Header{padding:0 1em;}}</style><div class="css-188wkox-Header"><style data-emotion-css="xv9p2a-Header">.css-xv9p2a-Header{white-space:nowrap;color:black;-webkit-text-decoration:none;text-decoration:none;}</style><a href="/" title="Go back to articles list" class="css-xv9p2a-Header">Diego Cuevas</a><style data-emotion-css="3pw79c-Header">.css-3pw79c-Header{overflow-x:auto;margin:-1em 0;padding:1em 0;}.css-3pw79c-Header a{padding:0 1em;}</style><nav class="css-3pw79c-Header"><style data-emotion-css="63vzel-Anchor">.css-63vzel-Anchor{color:#004BCC;-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="/articles/" target="_self" class="css-63vzel-Anchor">Articles</a></nav></div></header><style data-emotion-css="3s52de-Layout">.css-3s52de-Layout{margin:0 auto;max-width:40em;width:100%;position:relative;}@media (max-width:40em){.css-3s52de-Layout{font-size:0.9em;box-sizing:border-box;padding:0 2em;}}</style><section class="css-3s52de-Layout"><style data-emotion-css="g5mrd8-Date">.css-g5mrd8-Date{position:absolute;right:0.5em;bottom:100%;}</style><time dateTime="2022-02-28T18:00:00.000Z" class="css-g5mrd8-Date"><strong>febrero 28, 2022</strong></time><style data-emotion-css="1fu62su-Title">.css-1fu62su-Title{font-size:2.25em;font-weight:bold;-webkit-letter-spacing:-0.028em;-moz-letter-spacing:-0.028em;-ms-letter-spacing:-0.028em;letter-spacing:-0.028em;margin:1em 0;}</style><h1 class="css-1fu62su-Title">Como crear un Bot de discord usando Ruby</h1><style data-emotion-css="1i1xyuk-Description">.css-1i1xyuk-Description{border-left:3px solid black;box-sizing:border-box;padding-left:calc(0.5em - 3px);margin:-1em 0 1em -0.5em;font-size:1.5em;font-weight:200;}</style><p class="css-1i1xyuk-Description">En este articulo explicar√© como hacer un bot que mande memes a tu servidor de discord usando solo ruby ü§†</p><article><style data-emotion-css="1flccg0">.css-1flccg0{margin:1em 0;font-size:1em;}</style><p class="css-1flccg0">Primero debemos crear el bot en la <a href="https://discord.com/developers/applications" target="_blank" rel="nofollow noopener" class="css-63vzel-Anchor">pagina de discord</a>.</p><p class="css-1flccg0"><style data-emotion-css="qobgv5-Image">.css-qobgv5-Image{max-width:100%;vertical-align:top;}</style><img src="../../img/apps_discord.png" alt="discord" loading="lazy" class="css-qobgv5-Image"/></p><br/><p class="css-1flccg0">para obtener el token del bot debemos ir a la parte settings/Bot creas el bot y guardas el token que sale abajo del username del bot.</p><p class="css-1flccg0"><img src="../../img/bot.png" alt="bot" loading="lazy" class="css-qobgv5-Image"/></p><br/><p class="css-1flccg0">Despu√©s debemos agregar nuestro bot a nuestro servidor de discord, para ello debemos ir a la parte OAuth2 url generator seleccionar scope Bot y entrar a la url generada.</p><p class="css-1flccg0"><img src="../../img/generate_url.png" alt="url" loading="lazy" class="css-qobgv5-Image"/></p><p class="css-1flccg0">Seleccionar el servidor que queremos y listo! ahora solo debemos hacer las funciones de nuestro bot.</p><hr/><p class="css-1flccg0"><strong>Requerimientos:</strong>
Ya con el token podemos empezar a codear, usaremos e instalaremos las siguentes herramientas:</p><style data-emotion-css="1u91oiy-Blockquote">.css-1u91oiy-Blockquote{border-left:3px solid black;box-sizing:border-box;padding-left:calc(2em - 3px);margin-left:-2em;margin-right:0;font-weight:normal;font-size:1em;}.css-1u91oiy-Blockquote P{margin:0;}</style><blockquote class="css-1u91oiy-Blockquote"><p class="css-1flccg0"> Una gema de Ruby para interactuar con la API de Discord (<a href="https://www.rubydoc.info/gems/discordrb" target="_blank" rel="nofollow noopener" class="css-63vzel-Anchor">https://www.rubydoc.info/gems/discordrb</a>)</p><style data-emotion-css="ai5itc-Card">.css-ai5itc-Card{box-shadow:rgba(0,0,0,0.12) 0px 2px 5px 0px;background-color:white;border-radius:5px;-webkit-transition:all 0.2s ease 0s;transition:all 0.2s ease 0s;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;margin:1.5em -2em 3em;padding:1em 2em;}@media (max-width:720px){.css-ai5itc-Card{box-shadow:none;border-radius:0;margin:0;padding:1em 0.5em;}}</style><div class="css-ai5itc-Card"><style data-emotion-css="q7fqf3-Pre">.css-q7fqf3-Pre{overflow-x:auto;max-height:none;}.css-q7fqf3-Pre code{color:black;}.css-q7fqf3-Pre code:before{content:'';}.css-q7fqf3-Pre code:after{content:'';}</style><pre class="css-q7fqf3-Pre"><style data-emotion-css="timrsd-Code">.css-timrsd-Code{color:#f81ce5;font-family:Menlo,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif;font-size:0.8em;white-space:pre-wrap;}.css-timrsd-Code:before{content:'`';}.css-timrsd-Code:after{content:'`';}</style><code class="language-sh css-timrsd-Code">$ gem install discordrb 
</code></pre></div><p class="css-1flccg0">Necesitar√°s esto para que funcione la funci√≥n de voz de discordrb, a pesar de que no lo usemos la gema discordrb requiere de esto.</p><div class="css-ai5itc-Card"><pre class="css-q7fqf3-Pre"><code class="language-sh css-timrsd-Code">$ brew install libsodium 
</code></pre></div><p class="css-1flccg0">Otra biblioteca popular para audio/video requerida por discordrb para soporte de voz</p><div class="css-ai5itc-Card"><pre class="css-q7fqf3-Pre"><code class="language-sh css-timrsd-Code">$ brew install ffmpeg 
</code></pre></div><p class="css-1flccg0">Creamos un archivo <code class="css-timrsd-Code">main.rb</code> donde agregamos primero los <code class="css-timrsd-Code">require</code> de las herramientas que usaremos:</p></blockquote><div class="css-ai5itc-Card"><pre class="css-q7fqf3-Pre"><code class="language-rb css-timrsd-Code">require &quot;discordrb&quot;
require &quot;mechanize&quot;
require &quot;json&quot;
</code></pre></div><style data-emotion-css="dzr4hx">.css-dzr4hx{font-size:2em;font-weight:normal;margin:1em 0 0.25em;}</style><h2 id="creando-el-bot" class="css-dzr4hx">Creando el bot</h2><blockquote class="css-1u91oiy-Blockquote"><p class="css-1flccg0">Luego con el token que nos dieron podremos inicializar para crear los comandos de nuestro bot eso seria algo asi: </p><div class="css-ai5itc-Card"><pre class="css-q7fqf3-Pre"><code class="language-rb css-timrsd-Code">bot = Discordrb::Bot.new token: &#x27;XXXXXXXXXXXXXX&#x27;
</code></pre></div><p class="css-1flccg0">Entonces hacemos el <code class="css-timrsd-Code">bot.message(with_text: ‚Äòsome key word‚Äô)</code> para que cada vez que reconozca el key word o palabra clave entre a la funcion.</p><br/>En mi caso es &#x27;meme&#x27;</blockquote><div class="css-ai5itc-Card"><pre class="css-q7fqf3-Pre"><code class="language-rb css-timrsd-Code">bot.message(with_text: &#x27;meme&#x27;) do |event|
</code></pre></div><blockquote class="css-1u91oiy-Blockquote"><p class="css-1flccg0">Para traer la imagen usaremos mechanize que se utiliza para automatizar la interacci√≥n con los sitios web.</p><div class="css-ai5itc-Card"><pre class="css-q7fqf3-Pre"><code class="language-ruby css-timrsd-Code">agent = Mechanize.new
</code></pre></div><p class="css-1flccg0">buscamos una url que nos de images random de memes por ejemplo yo us√© esta url.</p><div class="css-ai5itc-Card"><pre class="css-q7fqf3-Pre"><code class="language-rb css-timrsd-Code">link = &#x27;https://meme-api.herokuapp.com/gimme&#x27;
</code></pre></div><p class="css-1flccg0">Hacemos un get al endpoint y parseamos la data a Json para obtener la url de la imagen.</p><div class="css-ai5itc-Card"><pre class="css-q7fqf3-Pre"><code class="css-timrsd-Code">response = JSON.parse(agent.get(link).body.to_s)
</code></pre></div><p class="css-1flccg0">Despu√©s yo hice esto, para obtener el nombre y su tipo como (‚Äú.gif‚Äù,‚Äù.png‚Äù).</p><div class="css-ai5itc-Card"><pre class="css-q7fqf3-Pre"><code class="language-rb css-timrsd-Code">name = response[&#x27;url&#x27;].split(&#x27;/&#x27;).last
</code></pre></div><p class="css-1flccg0">Entonces ya que tenemos la url de la imagen le hacemos un get a la url de la imagen y la guardamos con el nombre que obtenemos arriba.</p><div class="css-ai5itc-Card"><pre class="css-q7fqf3-Pre"><code class="language-rb css-timrsd-Code">agent.get(response[&quot;url&quot;]).save name
</code></pre></div><p class="css-1flccg0">Una vez guardada usamos el metodo ‚Äú.send_file‚Äù para mandar la imagen</p><div class="css-ai5itc-Card"><pre class="css-q7fqf3-Pre"><code class="language-rb css-timrsd-Code">event.send_file(File.open(name), caption: response[&quot;title&quot;])
</code></pre></div><p class="css-1flccg0">Despues mandar la imagen, le hacemos un sleep a nuestra funcion por dos segundos
(que hace que se detenga la funcion por el tiempo dicho), hacemos el sleep para que no se elimine mientras se esta subiendo la imagen.
y borramos la imagen de nuesta carpeta</p><div class="css-ai5itc-Card"><pre class="css-q7fqf3-Pre"><code class="language-rb css-timrsd-Code">sleep(2)
event File.delete(name)
</code></pre></div><p class="css-1flccg0">algo asi nos quedaria la funcion:</p><div class="css-ai5itc-Card"><pre class="css-q7fqf3-Pre"><code class="language-rb css-timrsd-Code">bot.message(with_text: &#x27;meme&#x27;) do |event|
  agent = Mechanize.new
  link = &#x27;https://meme-api.herokuapp.com/gimme&#x27;
  response = JSON.parse(agent.get(link).body.to_s)
  name = response[&#x27;url&#x27;].split(&#x27;/&#x27;).last
  agent.get(response[&quot;url&quot;]).save name
  event.send_file(File.open(name), caption: response[&quot;title&quot;])
  sleep(2)
  File.delete(name)
end
</code></pre></div></blockquote><p class="css-1flccg0">finalmente mandamos un mensaje meme en nuestro servidor de discord.</p><p class="css-1flccg0"><img src="../../img/meme.gif" alt="meme" loading="lazy" class="css-qobgv5-Image"/></p></article></section><style data-emotion-css="1ir0auf-Footer">.css-1ir0auf-Footer{background:white;border-top:1px solid #eaeaea;padding:2em 0;margin-top:3em;}</style><footer class="css-1ir0auf-Footer"><style data-emotion-css="qmed5e-Footer">.css-qmed5e-Footer{max-width:60rem;margin:0 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}@media (max-width:60rem) and (orientation:portrait){.css-qmed5e-Footer{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:0 2em;}}@media (max-width:60rem) and (orientation:landscape){.css-qmed5e-Footer{padding:0 2em;}}</style><div class="css-qmed5e-Footer"><style data-emotion-css="1akdp2w-Footer">.css-1akdp2w-Footer{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;}@media (max-width:60rem){.css-1akdp2w-Footer{margin-top:1em;}}</style><div class="css-1akdp2w-Footer"><style data-emotion-css="onei9h-Layout">.css-onei9h-Layout{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:none;background:none;color:black;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;font-size:0.8em;padding:0;margin-right:1em;}</style><button id="share" style="display:none" data-description="En este articulo explicar√© como hacer un bot que mande memes a tu servidor de discord usando solo ruby ü§†" class="css-onei9h-Layout"><style data-emotion-css="10n5572-Layout">.css-10n5572-Layout{margin-right:.5em;}</style><span class="css-10n5572-Layout">Share</span><svg width="16" height="16" viewBox="0 0 32 32"><path d="M27 22a4.985 4.985 0 00-3.594 1.526L9.937 16.792a5.035 5.035 0 000-1.582l13.469-6.734a5 5 0 10-1.343-2.683L8.594 12.527A5 5 0 105 21.001a4.985 4.985 0 003.594-1.526l13.469 6.734A5 5 0 1027 22z"></path></svg></button><style data-emotion-css="drd9vz-Footer">.css-drd9vz-Footer{color:black;-webkit-text-decoration:none;text-decoration:none;font-size:0.8em;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a href="https://github.com/DiegoCuevas/edit/master/articles/discord_bot.mdx" rel="alternate" title="Edit it on GitHub" class="css-drd9vz-Footer">Edit it on GitHub <style data-emotion-css="1rwtli9-Footer">.css-1rwtli9-Footer{height:18px;width:18px;margin-left:10px;}</style><i class="css-1rwtli9-Footer"><svg viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></i></a></div></div></footer><script src="/share.js"></script></div></main><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-164782098-1"></script><script src="/load-analytics.js"></script><script src="/load-sw.js"></script></body></html>